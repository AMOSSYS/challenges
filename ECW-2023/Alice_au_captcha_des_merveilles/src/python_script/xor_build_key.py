from binascii import hexlify
from itertools import cycle

if __name__ == "__main__":
    build_key_shellcode = b"\x55\x53\x48\x83\xEC\x18\x48\x8D\x6C\x24\x10\x48\x89\xCB\x48\x89\x55\x28\x4C\x89\x45\x30\x44\x89\xCA\x8B\x45\x40\x88\x55\x38\x88\x45\xFC\x0F\xB6\x13\x48\x8B\x45\x28\x88\x10\x8B\x53\x04\x48\x8B\x45\x28\x48\x83\xC0\x01\x88\x10\x48\x83\x7D\x30\x00\x74\x17\x48\x8B\x45\x28\x48\x83\xC0\x02\x8B\x53\x0D\x89\x10\x0F\xB7\x53\x11\x66\x89\x50\x04\xEB\x15\x48\x8B\x45\x28\x48\x83\xC0\x02\x8B\x53\x13\x89\x10\x0F\xB7\x53\x17\x66\x89\x50\x04\x80\x7D\x38\x00\x74\x17\x48\x8B\x45\x28\x48\x83\xC0\x08\x8B\x53\x19\x89\x10\x0F\xB7\x53\x1D\x66\x89\x50\x04\xEB\x15\x48\x8B\x45\x28\x48\x83\xC0\x08\x8B\x53\x27\x89\x10\x0F\xB7\x53\x2B\x66\x89\x50\x04\x80\x7D\xFC\x00\x74\x0F\x48\x8B\x45\x28\x48\x8D\x50\x0E\x8B\x43\x2D\x89\x02\xEB\x0D\x48\x8B\x45\x28\x48\x8D\x50\x08\x8B\x43\x31\x89\x02\x48\x8B\x45\x28\x48\x83\xC0\x12\x48\x8B\x53\x37\x48\x89\x10\x48\x8B\x53\x3D\x48\x89\x50\x06\x90\x48\x83\xC4\x18\x5B\x5D\xC3"
    xor_key = b"\xc6\x49\x22\xce\xd0\xd9\x6f\x92\x4e\xe6\x66\x8f\x51"
    #print(build_key_shellcode)

    build_key_shellcode_enc =  str(hexlify(bytes([_a ^ _b for _a, _b in zip(build_key_shellcode, cycle(xor_key))])))[2:-1]
    separator = "\\x"
    build_key_shellcode_enc_to_print = ""
    for i in range(0, len(build_key_shellcode_enc), 2):
        build_key_shellcode_enc_to_print += separator + build_key_shellcode_enc[i:i+2] 
    print(build_key_shellcode_enc_to_print)
    #print(build_key_shellcode_enc)
